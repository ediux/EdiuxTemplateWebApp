@using Microsoft.AspNet.Identity
@if (Request.IsAuthenticated)
{
    using (Html.BeginForm("LogOff", "Account", FormMethod.Post, new { id = "logoutForm", @class = "navbar-right" }))
    {
    @Html.AntiForgeryToken()
        <ul class="nav navbar-nav navbar-right  hidden-xs">
            @{Html.RenderAction("NotificationsBar", "Notifications"); }
            <li class="dropdown">
                <a data-toggle="dropdown" class="dropdown-toggle" href="#"> <i class="icon-tasks"></i> <span class="badge">7</span> </a>
                <ul class="dropdown-menu extended notification">
                    <li class="title">
                        <p>You have 7 pending tasks</p>
                    </li>
                    <li>
                        <a href="#">
                            <span class="task"> <span class="desc">Preparing new release</span> <span class="percent">30%</span> </span>
                            <div class="progress progress-small">
                                <div class="progress-bar progress-bar-info" style="width: 30%;"></div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <span class="task"> <span class="desc">Change management</span> <span class="percent">80%</span> </span>
                            <div class="progress progress-small progress-striped active">
                                <div class="progress-bar progress-bar-danger" style="width: 80%;"></div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <span class="task"> <span class="desc">Mobile development</span> <span class="percent">60%</span> </span>
                            <div class="progress progress-small">
                                <div class="progress-bar progress-bar-success" style="width: 60%;"></div>
                            </div>
                        </a>
                    </li>
                    <li>
                        <a href="#">
                            <span class="task"> <span class="desc">Database migration</span> <span class="percent">20%</span> </span>
                            <div class="progress progress-small">
                                <div class="progress-bar progress-bar-warning" style="width: 20%;"></div>
                            </div>
                        </a>
                    </li>
                    <li class="footer"> <a href="#">View all tasks</a> </li>
                </ul>
            </li>
            <li class="dropdown">
                <a data-toggle="dropdown" class="dropdown-toggle" href="#"> <i class="icon-envelope"></i> <span class="badge">1</span> </a>
                <ul class="dropdown-menu extended notification">
                    <li class="title">
                        <p>You have 3 new messages</p>
                    </li>
                    <li> <a href="#"> <span class="photo"> <img src="/Content/images/profile.png" width="34" height="34"></span> <span class="subject"> <span class="from">John Doe</span> <span class="time">Just Now</span> </span> <span class="text"> Consetetur sadipscing elitr...</span> </a> </li>
                    <li> <a href="#"> <span class="photo"><img src="/Content/images/profile.png" width="34" height="34"></span> <span class="subject"> <span class="from">John Doe</span> <span class="time">35 mins</span> </span> <span class="text"> Sed diam nonumy... </span> </a> </li>
                    <li> <a href="#"> <span class="photo"><img src="/Content/images/profile.png" width="34" height="34"></span> <span class="subject"> <span class="from">John Doe</span> <span class="time">5 hours</span> </span> <span class="text"> No sea takimata sanctus... </span> </a> </li>
                    <li class="footer"> <a href="#">View all messages</a> </li>
                </ul>
            </li>
            <li class="dropdown user  hidden-xs">
                <a data-toggle="dropdown" class="dropdown-toggle" href="#"> <i class="icon-male"></i> <span class="username">@User.Identity.GetUserName()</span> <i class="icon-caret-down small"></i> </a>
                <ul class="dropdown-menu">
                    <li><a href="@Url.Action("UserProfile","Manage",new { id=User.Identity.GetUserGuid() })"><i class="icon-user"></i> My Profile</a></li>
                    <li><a href="/Html/fullCalendar.html"><i class="icon-calendar"></i> My Calendar</a></li>
                    <li><a href="#"><i class="icon-tasks"></i> My Tasks</a></li>
                    @if (User.IsInRole("Admins") || User.Identity.GetUserName() == "root")
                    {
                    <li class="divider"></li>
                    <li><a href="@Url.Action("Index","Manage")"><i class="icon-dashboard"></i> 系統管理 </a></li>
                    }

                    <li class="divider"></li>
                    <li><a href="javascript:document.getElementById('logoutForm').submit()"><i class="icon-key"></i> 登出 </a></li>
                </ul>
            </li>
        </ul>
    }
}
else
{
    <ul class="nav navbar-nav navbar-right  hidden-xs">
        <li>@Html.ActionLink("註冊", "Register", "Account", routeValues: null, htmlAttributes: new { id = "registerLink" })</li>
        <li>@Html.ActionLink("登入", "Login", "Account", routeValues: null, htmlAttributes: new { id = "loginLink" })</li>
    </ul>
        }
